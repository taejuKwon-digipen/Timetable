# 시간표 관리 프로그램

Python과 PyQt6로 만든 **학생 수업 시간표 관리 프로그램**입니다. 학생별 가능/불가 시간대를 반영해 수업 블록을 생성하고, 드래그 앤 드롭으로 시간표를 편집할 수 있습니다.

---

## 목차

- [주요 기능](#주요-기능)
- [기술 스택](#기술-스택)
- [프로젝트 구조](#프로젝트-구조)
- [요구 사항](#요구-사항)
- [설치 및 실행](#설치-및-실행)
- [사용 방법](#사용-방법)
- [시간대 설정 규칙](#시간대-설정-규칙)
- [실행 파일(EXE) 빌드](#실행-파일exe-빌드)
- [데이터 저장](#데이터-저장)

---

## 주요 기능

### 학생 관리
- **학생 추가·수정·삭제**: 이름, 학년(초1~고3), 전화번호, 주소, 수업 시간(분), 주당 수업 횟수 입력
- **가능한 시간대**: “이 시간에만 수업 가능” 구간 지정 (요일·시작·끝 시·분)
- **불가능한 시간대**: “이 시간에는 수업 불가” 구간 지정 (요일·시작·끝 시·분)
- **요일 옵션**: 일~토, **평일**(월~금), **주말**(토·일) 단위 선택 가능

### 시간표 생성·편집
- **시간표 짜기**: 등록된 학생 기준으로 주당 수업 횟수만큼 **미배정 블록** 생성 (오른쪽 “미배정 블록” 목록에 표시)
- **7요일 지원**: 월~일 전체를 30분 단위(08:00~22:00) 그리드로 표시
- **드래그 앤 드롭**
  - **미배정 블록** → 시간표 그리드: 원하는 요일·시간 칸에 놓아 배정
  - **시간표 칸** → **미배정 블록** 영역: 배정 취소 후 다시 풀에서 배치 가능
- **가능 시간 하이라이트**: 블록을 잡고 드래그하면 해당 학생의 **가능한 시간**은 녹색, **불가/겹침** 구간은 연한 빨간색으로 표시
- **겹침 방지**: 다른 수업과 겹치거나 학생의 불가 시간대에는 드롭되지 않음

### 시각화
- **학년별 색상**: 초1~고3까지 학년마다 다른 색으로 수업 블록 표시
- **블록 정보**: 각 칸에 학생 이름·주소 표시

---

## 기술 스택

| 구분 | 내용 |
|------|------|
| 언어 | Python 3.x |
| GUI | PyQt6 (≥ 6.4.0) |
| DB | SQLite3 (내장) |
| 패키징 | PyInstaller (≥ 6.0.0, EXE 빌드 시) |

---

## 프로젝트 구조

```
TimetableGit/
├── main.py              # 진입점, QApplication 및 MainWindow 실행
├── main_window.py       # 메인 창: 학생 목록·시간표 페이지, 버튼·스택 UI
├── student.py           # Student, UnavailableSlot, AvailableSlot 데이터 클래스 및 가능 여부 로직
├── student_dialog.py     # 학생 추가/수정 대화상자 (폼·가능/불가 시간 테이블)
├── schedule_generator.py # ScheduleGenerator: 학생별 미배정 ScheduleBlock 생성
├── timetable_widget.py  # TimetableWidget, 그리드·미배정 풀·드래그 앤 드롭·하이라이트
├── db.py                # SQLite 연동: 학생·가능/불가 시간대 CRUD
├── timetable.db         # SQLite DB 파일 (실행 시 자동 생성)
├── requirements.txt     # pip 의존성 (PyQt6, pyinstaller)
├── run.bat              # Windows: py/python으로 main.py 실행
├── build.bat            # Windows: PyInstaller로 단일 exe 빌드
└── README.md
```

---

## 요구 사항

- **Python**: 3.10 이상 권장 (타입 힌트 `list[...]`, `int | None` 사용)
- **패키지**: `PyQt6` (실행 필수), `pyinstaller`(EXE 빌드 시)

---

## 설치 및 실행

### 1. 저장소 클론 또는 압축 해제 후 해당 폴더로 이동

```bash
cd TimetableGit
```

### 2. 가상환경 사용 (권장)

```bash
python -m venv venv
venv\Scripts\activate
```

### 3. 의존성 설치

```bash
pip install -r requirements.txt
```

또는 직접 설치:

```bash
pip install PyQt6>=6.4.0
```

### 4. 프로그램 실행

```bash
python main.py
```

Windows에서 `run.bat`을 더블클릭해 실행할 수도 있습니다. (`py main.py` 또는 `python main.py` 시도)

---

## 사용 방법

### 1단계: 학생 등록

1. **+ 학생 추가** 클릭
2. **이름**, **학년**, 전화번호, 주소, **수업 진행 시간(분)**, **수업 횟수(회/주)** 입력
3. **가능한 시간대**: “이 시간에만 수업 가능”할 때만 사용  
   - 비우고 **불가능한 시간대**만 쓰면 → “불가 제외한 나머지 전부 가능”
4. **불가능한 시간대**: “시간대 추가”로 요일·시작 시·분 ~ 끝 시·분 입력 (예: 월 09:00~12:00)
5. **확인**으로 저장 (DB에 즉시 반영)

수정은 목록에서 해당 학생 선택 후 **수정** 버튼 또는 더블클릭.

### 2단계: 시간표 생성

1. **시간표 짜기** 버튼 클릭
2. 화면이 시간표 페이지로 전환되고, 오른쪽에 **미배정 블록** 목록이 나타남 (학생별·회차별 블록)

### 3단계: 블록 배치

1. **미배정 블록**에서 블록을 끌어다 **시간표 그리드**의 원하는 요일·시간 칸에 놓기
2. 블록을 잡으면 해당 학생의 **가능한 시간**이 녹색, 불가/겹침 구간이 연한 빨간색으로 표시됨
3. 배정을 취소하려면 그리드의 블록을 **미배정 블록** 영역으로 드래그해 놓기
4. **← 학생 목록으로** 로 돌아가면 학생 목록 페이지로 이동 (시간표 데이터는 메모리에 유지, DB에는 시간표 자체는 저장되지 않음)

---

## 시간대 설정 규칙

- **요일**: `0=일, 1=월, …, 6=토`, `7=평일(월~금)`, `8=주말(토·일)`
- **가능한 시간대만 있을 때**: 입력한 구간 안에서만 수업 가능
- **불가능한 시간대만 있을 때**: 입력한 구간을 제외한 모든 시간 가능
- **둘 다 있을 때**: “가능한 시간” 이면서 “불가능한 시간”이 아닌 구간만 가능
- **둘 다 비어 있을 때**: 요일/시간 제한 없음 (전부 가능)

배치 시에는 30분 단위로 검사하며, 수업 길이 전체가 가능 구간에 포함되어야 드롭이 허용됩니다.

---

## 실행 파일(EXE) 빌드

Windows에서 단일 실행 파일로 만들 때:

1. PyInstaller 설치 (이미 있으면 생략)
   ```bash
   pip install pyinstaller
   ```
2. 프로젝트 폴더에서 `build.bat` 실행  
   또는 수동:
   ```bash
   py -m PyInstaller --onefile --windowed --name "TimeTable" --clean main.py
   ```
3. 생성된 exe 경로: `dist\TimeTable.exe`
4. 실행 시 **exe와 같은 폴더**에 `timetable.db`가 생성됩니다. exe만 배포할 경우 DB는 해당 폴더에 새로 만들어집니다.

---

## 데이터 저장

- **저장 위치**: 실행 파일(또는 스크립트)이 있는 폴더의 `timetable.db` (SQLite)
- **저장 내용**: 학생 정보(이름, 학년, 연락처, 주소, 수업 시간, 주당 횟수), 가능한 시간대, 불가능한 시간대
- **저장되지 않는 것**: 현재 화면의 시간표 배치(그리드에 놓은 결과)는 메모리에만 있고, 재실행 시 “시간표 짜기”를 다시 눌러 블록을 배치해야 합니다.

---

## 라이선스

이 프로젝트의 라이선스는 저장소 소유자에 따라 다릅니다.
